<svg xmlns="http://www.w3.org/2000/svg" height="4610" preserveAspectRatio="none" style="width:2105px;height:4610px" width="2105">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <path fill="#DDD" stroke="#a80036" d="M707 40.953h909v4563.461H707z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="1128" y="53.02">
    Mojaloop
  </text>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="439" x="831.25" y="28.708">
    PISP Linking: Credential registration (verification)
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#000" stroke-width="2" d="M775.5 2588.508h890v843.711h-890z"/>
  <path stroke="#a80036" d="M29 95.383v8"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M29 103.383v28"/>
  <path stroke="#a80036" d="M29 131.383v39.133"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M29 170.516v28"/>
  <path stroke="#a80036" d="M29 198.516v4364.601M797 95.383v8"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M797 103.383v28"/>
  <path stroke="#a80036" d="M797 131.383v39.133"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M797 170.516v28"/>
  <path stroke="#a80036" d="M797 198.516v4364.601"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M792 552.57h10v4010.547h-10z"/>
  <path stroke="#a80036" d="M985 95.383v8"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M985 103.383v28"/>
  <path stroke="#a80036" d="M985 131.383v39.133"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M985 170.516v28"/>
  <path stroke="#a80036" d="M985 198.516v4364.601M1560 95.383v8"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M1560 103.383v28"/>
  <path stroke="#a80036" d="M1560 131.383v39.133"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M1560 170.516v28"/>
  <path stroke="#a80036" d="M1560 198.516v4364.601M1649.5 95.383v8"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M1649.5 103.383v28"/>
  <path stroke="#a80036" d="M1649.5 131.383v39.133"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M1649.5 170.516v28"/>
  <path stroke="#a80036" d="M1649.5 198.516v4364.601"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M1644.5 943.758h10v3619.359h-10z"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M5 60.086h44v30.297H5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="12" y="80.081">
    PISP
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M711 60.086h168v30.297H711z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="718" y="80.081">
    Thirdparty-API-Adapter
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M893 60.086h180v30.297H893z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="900" y="80.081">
    Account Lookup Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1508 60.086h100v30.297h-100z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="1515" y="80.081">
    Auth Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1622 60.086h51v30.297h-51z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1629" y="80.081">
    DFSP
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M5 4563.117h44v30.297H5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="12" y="4583.112">
    PISP
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M711 4563.117h168v30.297H711z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="718" y="4583.112">
    Thirdparty-API-Adapter
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M893 4563.117h180v30.297H893z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="900" y="4583.112">
    Account Lookup Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1508 4563.117h100v30.297h-100z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="1515" y="4583.112">
    Auth Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1622 4563.117h51v30.297h-51z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1629" y="4583.112">
    DFSP
  </text>
  <path d="M8.25 136.383v25h1662v-15l-10-10H8.25" fill="#FBFB77" filter="url(#a)" stroke="#a80036"/>
  <path d="M1660.25 136.383v10h10l-10-10" fill="#FBFB77" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="1039" x="313.25" y="153.45">
    The PISP uses the FIDO registration flow to generate a new keypair and sign the challenge, relying on the user performing an &quot;unlock action&quot; on their mobile device.
  </text>
  <path fill="#A80036" stroke="#a80036" d="M780 548.57l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M29 552.57h757"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="36" y="381.043">
    CRED-10
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="103" y="214.583">
    PUT /consents/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="119" y="229.715">
    FSIOP-Source: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="119" y="244.848">
    FSPIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="119" y="259.981">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="135" y="275.114">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="151" y="290.247">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="167" y="305.379">
    accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="167" y="320.512">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="151" y="335.645">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="151" y="350.778">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="167" y="365.911">
    accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="167" y="381.043">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="151" y="396.176">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="135" y="411.309">
    ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="224" x="135" y="426.442">
    credential: {// This is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="151" y="441.575">
    credentialId: &quot;9876&quot;, //keyHandleId in FIDO speak
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="151" y="456.707">
    credentialType: &quot;FIDO&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="151" y="471.84">
    status: &quot;PENDING&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="376" x="151" y="486.973">
    signature: base64(...), // The signed challenge
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="288" x="151" y="502.106">
    payload: base64(...), // public key!
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="624" x="151" y="517.239">
    metadata: ... //TODO - metadata that the DFSP can use to verify this signature
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="135" y="532.372">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="119" y="547.504">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M40 577.703l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M34 581.703h757"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="46" y="576.637">
    CRED-11
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="113" y="576.637">
    202 Accepted
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1632.5 939.758l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M802 943.758h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="772.231">
    CRED-12
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="876" y="605.77">
    PUT /consents/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="892" y="620.903">
    FSIOP-Source: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="892" y="636.036">
    FSPIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="651.168">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="908" y="666.301">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="924" y="681.434">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="940" y="696.567">
    accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="940" y="711.7">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="924" y="726.832">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="924" y="741.965">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="940" y="757.098">
    accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="940" y="772.231">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="924" y="787.364">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="908" y="802.497">
    ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="224" x="908" y="817.629">
    credential: {// This is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="924" y="832.762">
    credentialId: &quot;9876&quot;, //keyHandleId in FIDO speak
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="924" y="847.895">
    credentialType: &quot;FIDO&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="924" y="863.028">
    status: &quot;PENDING&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="376" x="924" y="878.161">
    signature: base64(...), // The signed challenge
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="288" x="924" y="893.293">
    payload: base64(...), // public key!
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="624" x="924" y="908.426">
    metadata: ... //TODO - metadata that the DFSP can use to verify this signature
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="908" y="923.559">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="938.692">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 968.89l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M807 972.891h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="967.825">
    CRED-13
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="886" y="967.825">
    202 Accepted
  </text>
  <path fill="#FBFB77" filter="url(#a)" stroke="#a80036" d="M1207.5 985.891h884v144h-884z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="1211.5" y="1001.957">
    DFSP checks :
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="600" x="1211.5" y="1017.09">
    1. The challenge payload(s) were correctly derived from the scopes.accountId + scopes.action
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="383" x="1211.5" y="1047.356">
    If the DFSP opts to use the hub-hosted Auth-Service it then:
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="1211.5" y="1062.489">
    2. Registers the consent with the Auth Service
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="1509.5" y="1062.489">
    POST /thingo
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="447" x="1211.5" y="1077.622">
    3. If the DFSP recieves a `PUT /thingo/{id}` and the callback contains
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="1662.5" y="1077.622">
    Consent.credential.status
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="1866.5" y="1077.622">
    of
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="1882.5" y="1077.622">
    VERIFIED
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1946.5" y="1077.622">
    ,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="322" x="1227.5" y="1092.754">
    for each scope in the Consent, the DFSP creates a
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1553.5" y="1092.754">
    CredentialScope
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="860" x="1227.5" y="1107.887">
    else, if it recieves a `PUT /thingo/{id}/error` callback, it knows that the Consent is invalid, and can propagate the error back to the user
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 1621.336l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M807 1625.336h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="1385.711">
    CRED-14
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="886" y="1151.153">
    POST /thingo
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="902" y="1166.286">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="902" y="1181.418">
    FSPIOP-Destination: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="1196.551">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="918" y="1211.684">
    consentId: &quot;123
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1038" y="1211.684">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="918" y="1226.817">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="934" y="1241.95">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="950" y="1257.082">
    accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="950" y="1272.215">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="950" y="1287.348">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="966" y="1302.481">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="966" y="1317.614">
    partyIdentifier: &quot;qwerty-1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="950" y="1332.747">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="934" y="1347.879">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="934" y="1363.012">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="950" y="1378.145">
    accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="950" y="1393.278">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="950" y="1408.411">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="966" y="1423.543">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="966" y="1438.676">
    partyIdentifier: &quot;qwerty-5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="950" y="1453.809">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="934" y="1468.942">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="918" y="1484.075">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="918" y="1499.207">
    credential: {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="934" y="1514.34">
    credentialId: &quot;9876&quot;, //keyHandleId in FIDO speak
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="934" y="1529.473">
    credentialType: &quot;FIDO&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="264" x="934" y="1544.606">
    status: &quot;PENDING&quot;, //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="934" y="1559.739">
    signature: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="934" y="1574.872">
    payload: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="624" x="934" y="1590.004">
    metadata: ... //TODO - metadata that the DFSP can use to verify this signature
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="918" y="1605.137">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="1620.27">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1632.5 1650.469l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M802 1654.469h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="1649.403">
    CRED-15
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="876" y="1649.403">
    &quot;202 Accepted&quot;
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1548 2148.719l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M802 2152.719h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="1913.094">
    CRED-16
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="876" y="1678.536">
    POST /thingo
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="892" y="1693.668">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="892" y="1708.801">
    FSPIOP-Destination: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="1723.934">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="908" y="1739.067">
    consentId: &quot;123
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1028" y="1739.067">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="908" y="1754.2">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="924" y="1769.332">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="940" y="1784.465">
    accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="940" y="1799.598">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="940" y="1814.731">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="956" y="1829.864">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="956" y="1844.997">
    partyIdentifier: &quot;qwerty-1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="940" y="1860.129">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="924" y="1875.262">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="924" y="1890.395">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="940" y="1905.528">
    accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="940" y="1920.661">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="940" y="1935.793">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="956" y="1950.926">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="956" y="1966.059">
    partyIdentifier: &quot;qwerty-5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="940" y="1981.192">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="924" y="1996.325">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="908" y="2011.457">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="908" y="2026.59">
    credential: {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="924" y="2041.723">
    credentialId: &quot;9876&quot;, //keyHandleId in FIDO speak
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="924" y="2056.856">
    credentialType: &quot;FIDO&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="264" x="924" y="2071.989">
    status: &quot;PENDING&quot;, //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="924" y="2087.122">
    signature: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="924" y="2102.254">
    payload: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="624" x="924" y="2117.387">
    metadata: ... //TODO - metadata that the DFSP can use to verify this signature
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="908" y="2132.52">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="2147.653">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 2177.852l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M807 2181.852h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="2176.786">
    CRED-17
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="886" y="2176.786">
    &quot;202 Accepted&quot;
  </text>
  <path fill="#FBFB77" filter="url(#a)" stroke="#a80036" d="M1361 2194.852h398v53h-398z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="390" x="1365" y="2210.919">
    The Auth Service checks the signature against the challenge,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="381" x="1365" y="2226.051">
    and if provided, the metadata field to prove the authenticity
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="1365" y="2241.184">
    of the key.
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 2346.047l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M807 2350.047h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="2307.149">
    CRED-18
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="886" y="2269.317">
    PUT /thingo/9876
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="902" y="2284.45">
    FSIOP-Source: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="902" y="2299.582">
    FSPIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="894" y="2314.715">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="902" y="2329.848">
    status: &quot;VERIFIED&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="886" y="2344.981">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1548 2375.18l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M802 2379.18h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="2374.114">
    CRED-19
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="876" y="2374.114">
    &quot;200 OK&quot;
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1632.5 2479.977l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M802 2483.977h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="2441.079">
    CRED-20
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="876" y="2403.247">
    PUT /credentials/9876
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="892" y="2418.379">
    FSIOP-Source: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="892" y="2433.512">
    FSPIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="884" y="2448.645">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="892" y="2463.778">
    status: &quot;VERIFIED&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="876" y="2478.911">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 2509.11l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M807 2513.109h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="2508.044">
    CRED-21
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="886" y="2508.044">
    &quot;200 OK&quot;
  </text>
  <path fill="#FBFB77" filter="url(#a)" stroke="#a80036" d="M1399 2526.109h501v53h-501z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="452" x="1403" y="2542.176">
    DFSP is now satisfied that the credential registered by the PISP is valid,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="493" x="1403" y="2557.309">
    and now proceeds to register &quot;THIRD_PARTY_LINK&quot;s with the Auth Service and
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="1403" y="2572.442">
    ALS
  </text>
  <path d="M775.5 2588.508h77v7l-10 10h-67v-17" fill="#EEE" stroke="#000"/>
  <path fill="none" stroke="#000" stroke-width="2" d="M775.5 2588.508h890v843.711h-890z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="790.5" y="2601.575">
    loop
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="867.5" y="2600.718">
    [for each scope in
  </text>
  <text font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="987.5" y="2600.718">
    Consents.scopes
  </text>
  <text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="1092.5" y="2600.718">
    ]
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 2703.438l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M807 2707.438h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="2664.54">
    CRED-22
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="336" x="886" y="2626.707">
    POST /scopes/THIRD_PARTY_LINK/qwerty-56789
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="902" y="2641.84">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="902" y="2656.973">
    FSPIOP-Destination: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="2672.106">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="918" y="2687.239">
    credentialId: &quot;9876
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1070" y="2687.239">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="2702.372">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1632.5 2732.57l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M802 2736.57h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="2731.504">
    CRED-23
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="876" y="2731.504">
    202 Accepted
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1548 2837.367l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M802 2841.367h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="2798.469">
    CRED-24
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="336" x="876" y="2760.637">
    POST /scopes/THIRD_PARTY_LINK/qwerty-56789
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="892" y="2775.77">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="892" y="2790.903">
    FSPIOP-Destination: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="2806.036">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="908" y="2821.169">
    credentialId: &quot;9876
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1060" y="2821.169">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="2836.301">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 2866.5l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M807 2870.5h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="2865.434">
    CRED-25
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="886" y="2865.434">
    202 Accepted
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 2971.297l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M807 2975.297h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="2932.399">
    CRED-26
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="886" y="2894.567">
    PUT /scopes/THIRD_PARTY_LINK/qwerty-56789
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="902" y="2909.7">
    FSIOP-Source: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="902" y="2924.832">
    FSPIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="2939.965">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="918" y="2955.098">
    credentialId: &quot;9876
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1070" y="2955.098">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="2970.231">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1548 3000.43l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M802 3004.43h752"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="2999.364">
    CRED-27
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="876" y="2999.364">
    200 OK
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1632.5 3105.227l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M802 3109.227h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="809" y="3066.329">
    CRED-28
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="876" y="3028.497">
    PUT /scopes/THIRD_PARTY_LINK/qwerty-56789
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="892" y="3043.629">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="892" y="3058.762">
    FSPIOP-Destination: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="3073.895">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="908" y="3089.028">
    credentialId: &quot;9876
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1060" y="3089.028">
    &quot;
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="892" y="3104.161">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 3134.36l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M807 3138.359h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="3133.294">
    CRED-29
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="886" y="3133.294">
    200 OK
  </text>
  <path fill="#A80036" stroke="#a80036" d="M996 3224.023l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M990 3228.023h653.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="1002" y="3192.692">
    CRED-30
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="384" x="1069" y="3162.426">
    POST /participants/THIRD_PARTY_LINK/qwerty-56789
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="1085" y="3177.559">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1085" y="3192.692">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1101" y="3207.825">
    fspId: &quot;dfspa&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1085" y="3222.957">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1632.5 3253.156l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M985 3257.156h653.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="992" y="3252.09">
    CRED-31
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="1059" y="3252.09">
    202 Accepted
  </text>
  <path fill="#696969" filter="url(#a)" stroke="#a80036" d="M796.5 3270.156h377v23h-377z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="369" x="800.5" y="3286.223">
    ALS registers a new entry in the THIRD_PARTY_LINK oracle
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1632.5 3391.086l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M985 3395.086h653.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="992" y="3352.188">
    CRED-32
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="376" x="1059" y="3314.356">
    PUT /participants/THIRD_PARTY_LINK/qwerty-56789
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="1075" y="3329.489">
    FSIOP-Source: account-lookup-service
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="1075" y="3344.622">
    FSIOP-Destination: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1075" y="3359.754">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1091" y="3374.887">
    fspId: &quot;dfspa&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1075" y="3390.02">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M996 3420.219l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M990 3424.219h653.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="1002" y="3419.153">
    CRED-33
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="1069" y="3419.153">
    200 OK
  </text>
  <path fill="#FBFB77" filter="url(#a)" stroke="#a80036" d="M1409 3446.219h481v38h-481z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="473" x="1413" y="3462.286">
    Now that the Credentials are verified and registered with the Auth Service,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="320" x="1413" y="3477.419">
    the DFSP can update the PISP with the final status
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 3960.602l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M807 3964.602h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="3732.544">
    CRED-34
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="886" y="3505.551">
    PUT /consents/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="902" y="3520.684">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="902" y="3535.817">
    FSPIOP-Destination: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="3550.95">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="918" y="3566.082">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="934" y="3581.215">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="950" y="3596.348">
    accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="950" y="3611.481">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="950" y="3626.614">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="966" y="3641.747">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="966" y="3656.879">
    partyIdentifier: &quot;qwerty-1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="950" y="3672.012">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="934" y="3687.145">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="934" y="3702.278">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="950" y="3717.411">
    accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="950" y="3732.544">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="950" y="3747.676">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="966" y="3762.809">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="966" y="3777.942">
    partyIdentifier: &quot;qwerty-5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="950" y="3793.075">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="934" y="3808.207">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="918" y="3823.34">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="918" y="3838.473">
    credential: {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="934" y="3853.606">
    credentialId: &quot;9876&quot;, //keyHandleId in FIDO speak
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="934" y="3868.739">
    credentialType: &quot;FIDO&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="272" x="934" y="3883.872">
    status: &quot;VERIFIED&quot;, //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="934" y="3899.004">
    signature: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="934" y="3914.137">
    payload: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="624" x="934" y="3929.27">
    metadata: ... //TODO - metadata that the DFSP can use to verify this signature
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="918" y="3944.403">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="902" y="3959.536">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M813 3989.734l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M807 3993.734h836.5"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="819" y="3988.669">
    CRED-35
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="886" y="3988.669">
    200 OK
  </text>
  <path fill="#A80036" stroke="#a80036" d="M40 4472.852l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M34 4476.852h757"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="46" y="4244.793">
    CRED-36
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="113" y="4017.801">
    PUT /consents/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="129" y="4032.934">
    FSIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="129" y="4048.067">
    FSPIOP-Destination: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="129" y="4063.2">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="145" y="4078.332">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="161" y="4093.465">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="177" y="4108.598">
    accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="177" y="4123.731">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="177" y="4138.864">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="193" y="4153.997">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="193" y="4169.129">
    partyIdentifier: &quot;qwerty-1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="177" y="4184.262">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="161" y="4199.395">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="161" y="4214.528">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="177" y="4229.661">
    accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="177" y="4244.793">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="177" y="4259.926">
    partyIdInfo: { //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="193" y="4275.059">
    partyIdType: &quot;THIRD_PARTY_LINK&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="193" y="4290.192">
    partyIdentifier: &quot;qwerty-5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="177" y="4305.325">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="161" y="4320.458">
    },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="145" y="4335.59">
    ],
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="145" y="4350.723">
    credential: {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="161" y="4365.856">
    credentialId: &quot;9876&quot;, //keyHandleId in FIDO speak
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="161" y="4380.989">
    credentialType: &quot;FIDO&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="272" x="161" y="4396.122">
    status: &quot;VERIFIED&quot;, //this is new!
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="161" y="4411.254">
    signature: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="161" y="4426.387">
    payload: base64(...),
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="624" x="161" y="4441.52">
    metadata: ... //TODO - metadata that the DFSP can use to verify this signature
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="145" y="4456.653">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="129" y="4471.786">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M780 4501.984l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M29 4505.984h757"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="36" y="4500.918">
    CRED-37
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="103" y="4500.918">
    200 OK
  </text>
  <path d="M8.25 4518.984v25h1662v-15l-10-10H8.25" fill="#FBFB77" filter="url(#a)" stroke="#a80036"/>
  <path d="M1660.25 4518.984v10h10l-10-10" fill="#FBFB77" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="934" x="365.75" y="4536.051">
    Now we have a new identifier that the PISP can use to initiate transactions, a registered credential, and that credential is stored in the auth-service
  </text>
</svg>
