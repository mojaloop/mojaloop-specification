<svg xmlns="http://www.w3.org/2000/svg" height="1307" preserveAspectRatio="none" style="width:1633px;height:1307px" width="1633">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="570" x="531.5" y="28.708">
    Transfer: 3.4.1 Bad Signed Challenge - Self Hosted Auth-Service
  </text>
  <path fill="#DDD" stroke="#a80036" d="M1 40.953h104v1260.57H1z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="36.5" y="53.02">
    PISP
  </text>
  <path fill="#DDD" stroke="#a80036" d="M641.5 40.953h73v1260.57h-73z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="644.5" y="53.02">
    Mojaloop
  </text>
  <path fill="#DDD" stroke="#a80036" d="M1041 40.953h76v1260.57h-76z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="1052" y="53.02">
    DFSP A
  </text>
  <path stroke="#a80036" d="M53 111.68v10"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M53 121.68v40.804"/>
  <path stroke="#a80036" d="M53 162.484h0"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M53 162.484v40.805"/>
  <path stroke="#a80036" d="M53 203.289V1246.93M677.5 111.68v10"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M677.5 121.68v40.804"/>
  <path stroke="#a80036" d="M677.5 162.484h0"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M677.5 162.484v40.805"/>
  <path stroke="#a80036" d="M677.5 203.289V1246.93M1079 111.68v10"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M1079 121.68v40.804"/>
  <path stroke="#a80036" d="M1079 162.484h0"/>
  <path stroke="#a80036" stroke-dasharray="1,4" d="M1079 162.484v40.805"/>
  <path stroke="#a80036" d="M1079 203.289V1246.93"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M5 76.383h92v30.297H5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="12" y="96.378">
    PISP Server
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M5 1245.93h92v30.297H5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="12" y="1265.925">
    PISP Server
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M646.5 76.383h59v30.297h-59z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="653.5" y="96.378">
    Switch
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M646.5 1245.93h59v30.297h-59z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="653.5" y="1265.925">
    Switch
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1045 60.086h64v46.594h-64z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1052" y="80.081">
    DFSP A
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="1053" y="96.378">
    (Payer)
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1045 1245.93h64v46.594h-64z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1052" y="1265.925">
    DFSP A
  </text>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="1053" y="1282.222">
    (Payer)
  </text>
  <text font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="282" y="145.89">
    PISP has initiated Thirdparty Transaction Request with
  </text>
  <text font-family="monospace" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="259" x="595" y="145.89">
    POST /thirdpartyRequests/transactions
  </text>
  <text font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="299" x="418.5" y="186.695">
    DFSP A has received quote, and asked PISP to verify
  </text>
  <path d="M58 208.29v70h323v-60l-10-10H58" fill="#FBFB77" filter="url(#a)" stroke="#a80036"/>
  <path d="M371 208.29v10h10l-10-10" fill="#FBFB77" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="64" y="225.356">
    PISP looks up the
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="178" y="225.356">
    transactionRequestId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="342" y="225.356">
    and
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="64" y="240.489">
    checks the quote with the user,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="64" y="255.622">
    and uses the FIDO API to sign the
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="64" y="270.754">
    the
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="89" y="270.754">
    challenge
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="165" y="270.754">
    string
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M58 292.82h608v310H58z"/>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="600" x="62" y="308.887">
    PUT /thirdpartyRequests/authorizations/33333333-0000-0000-0000-000000000000
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="62" y="324.02">
    FSPIOP-Source: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="62" y="339.153">
    FSPIOP-Destination: dfspa
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="62" y="354.286">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="70" y="369.418">
    &quot;responseType&quot;: &quot;ACCEPTED&quot;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="70" y="384.551">
    &quot;signedPayload&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="78" y="399.684">
    &quot;signedPayloadType&quot;: &quot;FIDO&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="78" y="414.817">
    &quot;value&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="86" y="429.95">
    &quot;id&quot;: &quot;string&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="86" y="445.082">
    &quot;rawId&quot;: &quot;string - base64 encoded utf-8&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="86" y="460.215">
    &quot;response&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="338" x="94" y="475.348">
    &quot;authenticatorData&quot;: &quot;string - base64 encoded utf-8&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="318" x="94" y="490.481">
    &quot;clientDataJSON&quot;: &quot;string - base64 encoded utf-8&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="94" y="505.614">
    &quot;signature&quot;: &quot;string - base64 encoded utf-8&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="94" y="520.747">
    &quot;userHandle&quot;: &quot;string - base64 encoded utf-8&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="86" y="535.879">
    },
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="86" y="551.012">
    &quot;type&quot;: &quot;public-key&quot;
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="78" y="566.145">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="70" y="581.278">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="62" y="596.411">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M666 625.61l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M53 629.609h619"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="600" x="60" y="624.543">
    PUT /thirdpartyRequests/authorizations/33333333-0000-0000-0000-000000000000
  </text>
  <path fill="#A80036" stroke="#a80036" d="M64 654.742l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M58 658.742h619"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="70" y="653.676">
    200 OK
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1067 699.008l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M678 703.008h395"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="685" y="682.809">
    PUT /thirdpartyRequests/authorizations
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="296" x="685" y="697.942">
    /33333333-0000-0000-0000-000000000000
  </text>
  <path fill="#A80036" stroke="#a80036" d="M689 728.14l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M683 732.141h395"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="695" y="727.075">
    200 OK
  </text>
  <path stroke="#a80036" d="M1079 761.273h42M1121 761.273v13M1080 774.273h41"/>
  <path fill="#A80036" stroke="#a80036" d="M1090 770.273l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1086" y="756.207">
    Look up the
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="1165" y="756.207">
    transactionRequestId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="1329" y="756.207">
    for this
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1377" y="756.207">
    authorizationId
  </text>
  <path stroke="#a80036" d="M1079 803.406h42M1121 803.406v13M1080 816.406h41"/>
  <path fill="#A80036" stroke="#a80036" d="M1090 812.406l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1086" y="798.34">
    Look up the
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1165" y="798.34">
    consentId
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="1241" y="798.34">
    for this
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="1289" y="798.34">
    transactionRequestId
  </text>
  <path stroke="#a80036" d="M1079 845.539h42M1121 845.539v13M1080 858.539h41"/>
  <path fill="#A80036" stroke="#a80036" d="M1090 854.54l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1086" y="840.473">
    Look up the
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1165" y="840.473">
    publicKey
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="385" x="1241" y="840.473">
    for this ConsentId. Check the signing of the signed challenge
  </text>
  <path d="M893 871.54v25h368v-15l-10-10H893" fill="#FBFB77" filter="url(#a)" stroke="#a80036"/>
  <path d="M1251 871.54v10h10l-10-10" fill="#FBFB77" stroke="#a80036"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="347" x="899" y="888.606">
    Signed challenge is invalid. Transaction Request failed.
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M690 910.672h384v174H690z"/>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="288" x="694" y="926.739">
    PUT /thirdpartyRequests/transactions
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="344" x="726" y="941.872">
    /00000000-0000-0000-0000-000000000000/error
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="694" y="957.004">
    FSPIOP-Source: dfspa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="694" y="972.137">
    FSPIOP-Destination: pispa
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="694" y="987.27">
    {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="702" y="1002.403">
    &quot;errorInformation&quot;: {
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="710" y="1017.536">
    &quot;errorCode&quot;: &quot;71XX&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="710" y="1032.668">
    &quot;errorDescription&quot;: &quot;Invalid signed challenge&quot;,
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="710" y="1047.801">
    &quot;extensionList&quot;: []
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="702" y="1062.934">
    }
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="694" y="1078.067">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M689 1122.398l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M683 1126.398h395"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="695" y="1106.2">
    PUT /thirdpartyRequests/transactions
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="344" x="727" y="1121.332">
    /00000000-0000-0000-0000-000000000000/error
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1067 1151.531l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M678 1155.531h395"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="685" y="1150.465">
    200 OK
  </text>
  <path fill="#A80036" stroke="#a80036" d="M64 1195.797l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M58 1199.797h619"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="70" y="1179.598">
    PUT /thirdpartyRequests/transactions
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="344" x="102" y="1194.731">
    /00000000-0000-0000-0000-000000000000/error
  </text>
  <path fill="#A80036" stroke="#a80036" d="M666 1224.93l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M53 1228.93h619"/>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="60" y="1223.864">
    200 OK
  </text>
</svg>
